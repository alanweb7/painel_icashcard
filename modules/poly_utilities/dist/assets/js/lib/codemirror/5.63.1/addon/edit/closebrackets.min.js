var e;e=function(t){function k(t,n){return"pairs"==n&&"string"==typeof t?t:("object"==typeof t&&null!=t[n]?t:i)[n]}function r(i){var l,a,c;for(l=0;l<i.length;l++)a=i.charAt(l),n[c="'"+a+"'"]||(n[c]=function(n){return function(i){return function(n,i){var l,a,c,h,f,u,d,p,g,b,v,P,S,m,x,A=y(n);if(!A||n.getOption("disableInput"))return t.Pass;if(-1==(a=(l=k(A,"pairs")).indexOf(i)))return t.Pass;for(h=k(A,"closeBefore"),f=k(A,"triples"),u=l.charAt(a+1)==i,d=n.listSelections(),p=a%2==0,g=0;g<d.length;g++){if(P=(v=d[g]).head,S=n.getRange(P,o(P.line,P.ch+1)),p&&!v.empty())b="surround";else if(!u&&p||S!=i)if(u&&1<P.ch&&0<=f.indexOf(i)&&n.getRange(o(P.line,P.ch-2),P)==i+i){if(2<P.ch&&/\bstring/.test(n.getTokenTypeAt(o(P.line,P.ch-2))))return t.Pass;b="addFour"}else if(u){if(v=0==P.ch?" ":n.getRange(o(P.line,P.ch-1),P),t.isWordChar(S)||v==i||t.isWordChar(v))return t.Pass;b="both"}else{if(!p||!(0===S.length||/\s/.test(S)||-1<h.indexOf(S)))return t.Pass;b="both"}else b=u&&function(t,n){var i=t.getTokenAt(o(n.line,n.ch+1));return/\bstring/.test(i.type)&&i.start==n.ch&&(0==n.ch||!/\bstring/.test(t.getTokenTypeAt(n)))}(n,P)?"both":0<=f.indexOf(i)&&n.getRange(P,o(P.line,P.ch+3))==i+i+i?"skipThree":"skip";if(c){if(c!=b)return t.Pass}else c=b}m=a%2?l.charAt(a-1):i,x=a%2?i:l.charAt(a+1),n.operation((function(){var i,l,a,h;if("skip"==c)O(n,1);else if("skipThree"==c)O(n,3);else if("surround"==c){for(i=n.getSelections(),l=0;l<i.length;l++)i[l]=m+i[l]+x;for(n.replaceSelections(i,"around"),i=n.listSelections().slice(),l=0;l<i.length;l++)i[l]=(a=i[l],h=void 0,h=0<t.cmpPos(a.anchor,a.head),{anchor:new o(a.anchor.line,a.anchor.ch+(h?-1:1)),head:new o(a.head.line,a.head.ch+(h?1:-1))});n.setSelections(i)}else"both"==c?(n.replaceSelection(m+x,null),n.triggerElectric(m+x),O(n,-1)):"addFour"==c&&(n.replaceSelection(m+m+m+m,"before"),O(n,1))}))}(i,n)}}(a))}function y(t){var n=t.state.closeBrackets;return n&&!n.override&&t.getModeAt(t.getCursor()).closeBrackets||n}function O(t,n){var i,o,l,a,c;for(i=[],o=t.listSelections(),l=0,a=0;a<o.length;a++)(c=o[a]).head==t.getCursor()&&(l=a),c=c.head.ch||0<n?{line:c.head.line,ch:c.head.ch+n}:{line:c.head.line-1},i.push({anchor:c,head:c});t.setSelections(i,l)}function s(t,n){return 2==(n=t.getRange(o(n.line,n.ch-1),o(n.line,n.ch+1))).length?n:null}var n,i={pairs:"()[]{}''\"\"",closeBefore:")]}'\":;>",triples:"",explode:"[]{}"},o=t.Pos;t.defineOption("autoCloseBrackets",!1,(function(i,o,l){l&&l!=t.Init&&(i.removeKeyMap(n),i.state.closeBrackets=null),o&&(r(k(o,"pairs")),i.state.closeBrackets=o,i.addKeyMap(n))})),n={Backspace:function(n){var i,l,a,c,h,f=y(n);if(!f||n.getOption("disableInput"))return t.Pass;for(i=k(f,"pairs"),l=n.listSelections(),a=0;a<l.length;a++){if(!l[a].empty())return t.Pass;if(!(c=s(n,l[a].head))||i.indexOf(c)%2!=0)return t.Pass}for(a=l.length-1;0<=a;a--)h=l[a].head,n.replaceRange("",o(h.line,h.ch-1),o(h.line,h.ch+1),"+delete")},Enter:function(n){var i,o,l,a=y(n),c=a&&k(a,"explode");if(!c||n.getOption("disableInput"))return t.Pass;for(i=n.listSelections(),o=0;o<i.length;o++){if(!i[o].empty())return t.Pass;if(!(l=s(n,i[o].head))||c.indexOf(l)%2!=0)return t.Pass}n.operation((function(){var t,o,l=n.lineSeparator()||"\n";for(n.replaceSelection(l+l,null),O(n,-1),i=n.listSelections(),t=0;t<i.length;t++)o=i[t].head.line,n.indentLine(o,null,!0),n.indentLine(o+1,null,!0)}))}},r(i.pairs+"`")},"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror);