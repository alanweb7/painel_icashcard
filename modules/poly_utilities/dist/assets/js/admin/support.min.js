!function(o){"use strict";function cloneAndRemoveEvents(){var o,t,e,i,l;PolyOperationFunctions.Scrolling(),window.location.href.includes("admin/poly_utilities/support")&&((e=document.querySelectorAll(".poly-element.support")).forEach((function(o){var t,e,i=o.querySelectorAll(".line");i.forEach((function(o){o.remove()})),(t=o.querySelectorAll(".prompt")).forEach((function(o){o.remove()})),e=o.cloneNode(!0),o.parentNode.replaceChild(e,o)})),i=document.getElementById("poly_aio_supports_icon_bottom"),l=document.getElementById("poly_aio_supports_icon_right"),PolyDragElements.initializeDrag(".poly-element.support",{unit:"px",wrapperStyle:{border:"1px dashed #FC0000",padding:"0px 8px"},right:null!==(o=poly_utilities_settings.aio_supports.icon_right)&&void 0!==o?o:10,bottom:null!==(t=poly_utilities_settings.aio_supports.icon_bottom)&&void 0!==t?t:60,callback:function callback(o){void 0!==o.top?(i.value="".concat(o.top),l.value="".concat(o.left)):void 0!==o.bottom&&(i.value="".concat(o.bottom),l.value="".concat(o.right))}}))}function updateDataFields(){var t,e,i=[];o(".poly-field-template.active").each((function(){var t=o(this).find(".poly_aio_supports_icon").val(),e=o(this).find(".poly_aio_supports_types").val(),l=t,n=o(this).find(".poly_aio_supports_icon_color").val(),s=o(this).find(".poly_aio_supports_title").val(),a=o(this).find(".poly_aio_supports_content").val();i.push({type:e,icon:l,icon_color:n,title:s,content:a})})),t={is_admin:o("#poly_aio_support_is_admin").prop("checked"),is_clients:o("#poly_aio_support_is_clients").prop("checked"),is_messages:o("#poly_aio_is_supports_messages").prop("checked"),is_messages_mobile:o("#poly_aio_is_supports_messages_mobile").prop("checked"),icon_right:o(".poly_aio_supports_icon_right").val(),icon_bottom:o(".poly_aio_supports_icon_bottom").val(),icon_button:o(".poly_aio_supports_icon_button").val(),icon_button_color:o(".poly_aio_supports_icon_button_color").val(),messages:o("#poly_aio_supports_messages").val().split("\n").map((function(o){return o.trim()})).filter(Boolean),supports:JSON.stringify(i)},(e=o(".poly_aio_supports-form")).valid()&&o.post(admin_url+"poly_utilities/save_aio_supports",{data:t}).done((function(o){var t=o;t.title="Alert",PolyMessage.displayNotification(t.status,t.message)}))}PolyOperationFunctions.DisableReload(),PolyUtilities.addBackdrop(".poly-utilities-aio-icon-select-position",{zIndex:9001,isCloseReload:!0,tooltip:"Drag and move the All-in-One icon to set its display position on the page. Then close it to update the new position.",backgroundColor:"rgba(0, 0, 0, 0.8)"},cloneAndRemoveEvents,updateDataFields),PolyOperationFunctions.Icons(o(".poly-utilities-aio-icon-select")),o("#add-field").on("click",(function(){var t=o(".poly-fields-template .poly-field-template").clone().addClass("active"),e=PolyCommon.generateUniqueID(),i=t.find(".poly-utilities-aio-icon-select"),l=t.find(".poly-aio-handle-delete");t.attr("id",e),l.attr("data-id",e),i.attr("data-id",e),o("#repeater-fields").append(t).promise().done((function(){appColorPicker(),PolyOperationFunctions.Icons(o(".poly-utilities-aio-icon-select"))}))})),o("#repeater-fields").on("click",".poly-aio-handle-delete",(function(){var t=this;Swal.fire({title:poly_utilities_settings.popup_delete.header,text:poly_utilities_settings.popup_delete.message,showCancelButton:!0,confirmButtonColor:poly_utilities_settings.popup_delete.confirm_color,cancelButtonColor:poly_utilities_settings.popup_delete.cancel_color,cancelButtonText:poly_utilities_settings.popup_delete.cancel,confirmButtonText:poly_utilities_settings.popup_delete.confirm,allowOutsideClick:!1}).then((function(e){e.isConfirmed&&(o("#".concat(o(t).data("id"))).remove(),updateDataFields())}))})),Sortable.create(o("#repeater-fields").get(0),{handle:".poly-aio-handle-sortable",selectedClass:"selected",animation:150,onEnd:function onEnd(o){updateDataFields()}}),o(".poly_aio_is_supports").on("click",(function(){updateDataFields()})),o(".btn-submit-poly-aio-supports").on("click",(function(){updateDataFields()}))}(jQuery);