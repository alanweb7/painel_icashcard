(()=>{function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function _iterableToArrayLimit(e,t){var n,a,o,i,l,r,u,s=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=s){l=[],r=!0,u=!1;try{if(o=(s=s.call(e)).next,0===t){if(Object(s)!==s)return;r=!1}else for(;!(r=(n=o.call(s)).done)&&(l.push(n.value),l.length!==t);r=!0);}catch(e){u=!0,a=e}finally{try{if(!r&&null!=s.return&&(i=s.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}function _arrayWithHoles(e){if(Array.isArray(e))return e}window.addEventListener("load",(function(){!function(e){"use strict";var t=Vue,n=t.createApp,a=t.ref,o=t.watch,i=t.onMounted,l=t.nextTick,r=n({setup:function setup(){function initDataDefault(){w.value={name:"",parent_slug:"root",target:"_self",rel:"nofollow",type:"default",badge:{color:"",value:""}}}function definedWatchLoad(){M=e(".poly-colorpicker-input-value"),I=e(".select2.clients")}function updateColorPicker(){var e,t="",n=(null==w||null===(e=w.value)||void 0===e||null===(e=e.badge)||void 0===e?void 0:e.color)||t;M.val(n)}function fetchData(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Promise.all([fetchDefaultSettings(),fetchMenuItems(),fetchCustomMenuItems()]).then((function(e){var t=_slicedToArray(e,3),n=t[0],a=t[1],o=t[2];b.value=_toConsumableArray(a),o.forEach((function(e){try{e.hasOwnProperty("aclients")||(e.aclients=e.clients?JSON.parse(e.clients):[])}catch(t){e.aclients=[]}})),C.value=o,h.value=n,T.value=!0})).catch((function(e){}))}function fetchDefaultSettings(){return new Promise((function(t,n){e.ajax({url:"".concat(admin_url,"poly_utilities/ajax_default_settings"),type:"GET",dataType:"json",success:function success(e){t(e)},error:function error(e,t,a){n(a)}})}))}function fetchMenuItems(){return new Promise((function(t,n){e.ajax({url:"".concat(admin_url,"poly_utilities/ajax_client_menu_items"),type:"GET",dataType:"json",success:function success(e){t(e)},error:function error(e,t,a){n(a)}})}))}function updateMenuOptions(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=e("body").find("#poly-active-menu .list-group-item").not(".list-group-item.sub"),a=!1,o=[];e.each(n,(function(t,n){var i,l,r,u,s,c,d,p=e(this);!1===a?a=t+1:a++,u=(u=p.data("require_login")||!1)?"on":"",s={name:p.data("name"),is_custom:null!==(i=p.data("is_custom"))&&void 0!==i&&i,require_login:u,id:p.data("id"),slug:p.data("slug"),type:p.data("type"),css:p.data("css"),href:null!==(l=p.data("href_original"))&&void 0!==l?l:p.data("href"),target:p.data("target"),rel:p.data("rel"),parent_slug:null!==(r=p.data("parent_slug"))&&void 0!==r?r:"root",icon:p.data("icon"),badge:p.data("badge"),position:a,children:[]},c=p.find(".list-group-item.sub").filter((function(){return e(this).data("parent_slug")===p.data("slug")})),d=!1,e.each(c,(function(t,n){var a,o,i,l,r,u,c;!1===d?d=t+1:d++,void 0!==(a=e(this)).data("id")&&(l=(l=a.data("require_login")||!1)?"on":"",r={id:a.data("id"),name:a.data("name"),is_custom:null!==(o=a.data("is_custom"))&&void 0!==o&&o,require_login:l,slug:a.data("slug"),type:a.data("type"),css:a.data("css"),href:null!==(i=a.data("href_original"))&&void 0!==i?i:a.data("href"),target:a.data("target"),rel:a.data("rel"),parent_slug:a.data("parent_slug"),icon:a.data("icon"),badge:a.data("badge"),position:d,children:[]},u=a.find(".list-group-item.sub").filter((function(){return e(this).data("parent_slug")===a.data("slug")})),c=!1,e.each(u,(function(t,n){var a,o,i,l,u;!1===c?c=t+1:c++,void 0!==(a=e(this)).data("id")&&(l=(l=a.data("require_login")||!1)?"on":"",u={id:a.data("id"),name:a.data("name"),is_custom:null!==(o=a.data("is_custom"))&&void 0!==o&&o,require_login:l,slug:a.data("slug"),type:a.data("type"),css:a.data("css"),href:null!==(i=a.data("href_original"))&&void 0!==i?i:a.data("href"),target:a.data("target"),rel:a.data("rel"),parent_slug:a.data("parent_slug"),icon:a.data("icon"),badge:a.data("badge"),position:c},r.children.push(u))})),s.children.push(r))})),o.push(s)})),e.post(admin_url+"poly_utilities/update_clients_menu_positions",{data:o}).done((function(e){var t=e;window.location.reload(),PolyMessage.displayNotification(t.status,t.message)}))}function fetchCustomMenuItems(){return new Promise((function(t,n){e.ajax({url:"".concat(admin_url,"poly_utilities/ajax_custom_clients_menu_items"),type:"GET",dataType:"json",success:function success(e){t(e)},error:function error(e,t,a){n(a)}})}))}function handleClientInfo(e){window.open("".concat(admin_url,"clients/client/").concat(e.id),"_blank")}function isEdit(e){x.value=e}function validationForm(e,t){var n,a=Object.fromEntries(e.entries()),o=!0;return a.name.trim()?t.value.name=null:(t.value.name="Title cannot be empty.",o=!1),n=["default","iframe"],!a.href.trim()&&n.includes(w.value.type)?(t.value.href="Href cannot be empty.",o=!1):t.value.href=null,o}var t,n,r,u,s,c,d,p,f,m,v,_,y,g,h=a([]),b=a([]),w=a({}),C=a([]),T=a(!1),A=a(!1),x=a(!1),S=a([]),I=null,M=null,P=a({});return initDataDefault(),o([b,C,w],(function(){l().then((function(){definedWatchLoad(),t(),appColorPicker(),updateColorPicker(),PolyOperationFunctions.Icons(e(".poly-utilities-aio-icon-select")),I.length>0&&(I.select2({placeholder:"Select clients",width:"resolve",delay:250,minimumInputLength:2,ajax:{url:"".concat(admin_url,"poly_utilities/ajax_clients_search"),dataType:"json",data:function data(e){var t;return{search:e.term,type:"public"}},processResults:function processResults(e){var t;return{results:e.map((function(e){return{id:e.userid,text:"".concat(e.company," ").concat(e.phonenumber)}}))}}},templateResult:function templateResult(t){return t.id?e('<div class="poly-utilities-user-search-result">'.concat(t.text,"</div>")):t.text;var n},templateSelection:function templateSelection(t){return t.id?e('<span class="poly-utilities-user-search-result">'.concat(t.text,"</span>")):t.text;var n},escapeMarkup:function escapeMarkup(e){return e}}),I.on("change",(function(t){var n=I.select2("data"),a=n.map((function(t){return{id:t.id,text:t.text,avatar:e(t.element).data("avatar")||t.avatar}}));S.value=a})))}))})),i((function(){fetchData(),e(document).on("click",".list-group.nested-sortable",(function(t){var n,a,o,i;t.preventDefault(),t.stopPropagation(),o=(a=(n=e(t.target)).closest("div")).find(".toggle-widgets i"),(i=a.find(".list-group.nested-sortable").first()).length&&(i.slideToggle(),o.hasClass("fa-caret-up")?o.removeClass("fa-caret-up").addClass("fa-caret-down"):o.removeClass("fa-caret-down").addClass("fa-caret-up"))}))})),t=function setupSortable(){var e,t=[].slice.call(document.querySelectorAll(".poly-menu .nested-sortable"));for(e=0;e<t.length;e++)new Sortable(t[e],{group:"poly-menu",animation:150,fallbackOnBody:!0,swapThreshold:.65,onStart:function onStart(e){var t=e.item},onAdd:function onAdd(e){var t,n=e.item,a=n.parentNode;a.classList.contains("list-group")&&(null!==(t=a.parentNode.getAttribute("data-slug"))?(n.classList.add("sub"),n.setAttribute("data-parent_slug",t)):(n.setAttribute("data-parent_slug","root"),n.classList.remove("sub")))},onEnd:function onEnd(e){updateMenuOptions()}})},n=function handleDividerStyles(e){return PolyCustomMenu.HandleDividerStyles(e)},r=function handleSubmit(t){var n,a;if(A.value=!0,n=e("#poly_utilities_add_custom_sidebar_form").get(0),!validationForm(a=new FormData(n),P))return A.value=!1,!1;a.set("clients",JSON.stringify(S.value)),a.append("is_edit",x.value),a.append("is_custom","true"),!0===x.value&&(a.append("id",w.value.id),a.append("slug",w.value.slug),a.append("position",w.value.position)),fetch(n.action,{method:"POST",body:a}).then((function(e){if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((function(e){x.value?(window.location.reload(),PolyMessage.displayNotification("".concat(e.status),"".concat(e.message))):window.location.reload()})).catch((function(e){})).finally((function(){A.value=!1}))},u=function initDefaultValue(e){var t,n,a,o,i,l,r;e.type=null!==(t=e.type)&&void 0!==t?t:"default",e.target=null!==(n=e.target)&&void 0!==n?n:"_self",e.rel=null!==(a=e.rel)&&void 0!==a?a:"follow",e.parent_slug=null!==(o=null==e?void 0:e.parent_slug)&&void 0!==o?o:"root",e.href=null!==(i=null==e?void 0:e.href_original)&&void 0!==i?i:e.href,r=null!==(l=null==e?void 0:e.position)&&void 0!==l?l:0,r=parseInt(r),e.position=r},s=function handleClone(t){var n,a,o,i,l,r=t.id+"_cloned";t.id=r,t.slug=r,t.is_custom=!0,t.clients=null!==(n=t.clients)&&void 0!==n?n:"[]",u(t),t.name=y(t.name),t.badge={color:null!==(a=null==t||null===(o=t.badge)||void 0===o?void 0:o.color)&&void 0!==a?a:"",value:null!==(i=null==t||null===(l=t.badge)||void 0===l?void 0:l.value)&&void 0!==i?i:""},t.position=0,e.post(admin_url+"poly_utilities/clone_clients_menu",{data:t}).done((function(e){var t=e;PolyMessage.displayNotification(t.status,t.message),fetchData()}))},c=function decodeHtml(e){return PolyCustomMenu.decodeHtml(e)},d=function handleIcon(e){var t=PolyCustomMenu.decodeHtml(e.icon);return t.includes("<svg")?t:'<i class="'.concat(e.icon,'">&nbsp;</i>')},p=function handleEdit(e){var t,n,a,o,i,l,r,s,c,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;PolyOperationFunctions.Scrolling(),x.value=!0,e.require_login=!!e.require_login,"iframe"===e.type&&e.href_original&&(e.href=e.href_original),w.value=e,null!=e&&e.icon&&(r=PolyCustomMenu.decodeHtml(e.icon)).includes("<svg")&&(w.value.svg=e.icon,w.value.icon=""),w.value.name=PolyCommon.extractTextFromHtml(w.value.name),e.clients=null!==(t=e.clients)&&void 0!==t?t:"[]",e.is_custom=null!==(n=e.is_custom)&&void 0!==n?n:"false",u(e),e.badge={color:null!==(a=null==e||null===(o=e.badge)||void 0===o?void 0:o.color)&&void 0!==a?a:"",value:null!==(i=null==e||null===(l=e.badge)||void 0===l?void 0:l.value)&&void 0!==i?i:""},c=(s=JSON.parse(e.clients)).map((function(e){return{id:e.id,text:e.text}})),S.value=c,I.empty(),c.forEach((function(e){var t=new Option(e.text,e.id,!0,!0);I.append(t)})),updateColorPicker()},f=PolyComponents.useFilteredTypes(w,h),{default_settings:h,dataLoaded:T,isProccessing:A,validation_fields:P,menu_items:b,custom_menu_items:C,item_edit_object:w,is_edit:x,isEdit,handleEdit:p,decodeHtml:c,handleIcon:d,handleClone:s,handleDelete:m=function handleDelete(t){var n={};n.id=t.slug,Swal.fire({title:poly_utilities_settings.popup_delete.header,text:poly_utilities_settings.popup_delete.message,showCancelButton:!0,confirmButtonColor:poly_utilities_settings.popup_delete.confirm_color,cancelButtonColor:poly_utilities_settings.popup_delete.cancel_color,cancelButtonText:poly_utilities_settings.popup_delete.cancel,confirmButtonText:poly_utilities_settings.popup_delete.confirm,allowOutsideClick:!1}).then((function(t){t.isConfirmed&&e.post(admin_url+"poly_utilities/delete_custom_clients_menu",n).done((function(e){window.location.reload()}))}))},handleSubmit:r,handleClientInfo,handleReactivationModule:_=function handleReactivationModule(){PolyCustomMenu.handleReactivationModule()},extractTextFromHtml:y=function extractTextFromHtml(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""},handleDividerStyles:n,handleResetCustomMenu:v=function handleResetCustomMenu(e){PolyCustomMenu.HandleResetCustomMenu(e)},filteredTypes:f,removeIcon:g=function removeIcon(e){null!=e&&e.icon&&(e.icon=""),null!=e&&e.svg&&(e.svg="")}}}}).mount("#polyApp")}(jQuery)}))})();